<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QPhO | 物理奥林匹克试卷库</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* 基础变量 */
:root {
  --primary: #4361ee;
  --primary-dark: #3a56d4;
  --secondary: #7209b7;
  --accent: #f72585;
  --success: #4cc9f0;
  --warning: #f8961e;
  --danger: #f94144;
  --light: #f8f9fa;
  --dark: #212529;
  --gray-100: #f8f9fa;
  --gray-200: #e9ecef;
  --gray-300: #dee2e6;
  --gray-400: #ced4da;
  --gray-500: #adb5bd;
  --gray-600: #6c757d;
  --gray-700: #495057;
  --gray-800: #343a40;
  --gray-900: #212529;
  --gradient-primary: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
  --gradient-secondary: linear-gradient(135deg, #7209b7 0%, #560bad 100%);
  --gradient-accent: linear-gradient(135deg, #f72585 0%, #b5179e 100%);
  --gradient-dark: linear-gradient(135deg, #212529 0%, #343a40 100%);
  --gradient-qpho: linear-gradient(135deg, #f72585 0%, #4361ee 100%);
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
  --shadow-md: 0 4px 8px rgba(0,0,0,0.12);
  --shadow-lg: 0 8px 16px rgba(0,0,0,0.15);
  --shadow-xl: 0 12px 24px rgba(0,0,0,0.2);
  --shadow-xxl: 0 20px 40px rgba(0,0,0,0.25);
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-round: 50%;
  --transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  --font-heading: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* 重置和基础样式 */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-body);
  font-size: 16px;
  line-height: 1.6;
  color: var(--gray-800);
  background-color: #f9fafb;
  overflow-x: hidden;
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-heading);
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 1rem;
}

a {
  text-decoration: none;
  color: inherit;
  transition: all var(--transition-fast);
}

ul {
  list-style: none;
}

button, input, select, textarea {
  font-family: inherit;
  font-size: inherit;
}

.container {
  width: 100%;
  max-width: 1280px;
  margin: 0 auto;
  padding: 0 20px;
}

/* 动画 - 减小幅度 */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeInUp {
  from { 
    opacity: 0; 
    transform: translateY(15px);
  }
  to { 
    opacity: 1; 
    transform: translateY(0);
  }
}

@keyframes slideInLeft {
  from { 
    opacity: 0; 
    transform: translateX(-20px);
  }
  to { 
    opacity: 1; 
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from { 
    opacity: 0; 
    transform: translateX(20px);
  }
  to { 
    opacity: 1; 
    transform: translateX(0);
  }
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* 动效工具类 */
.animate-fade-in {
  animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.animate-fade-up {
  animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.animate-slide-left {
  animation: slideInLeft 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.animate-slide-right {
  animation: slideInRight 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.animate-pulse {
  animation: pulse 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.animate-float {
  animation: float 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.animate-gradient {
  animation: gradientShift 3s ease infinite;
  background-size: 200% 200%;
}

/* 加载动画 */
.shimmer {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 1000px 100%;
  animation: shimmer 2s infinite;
}

/* 顶部导航栏 */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow-md);
  z-index: 1000;
  padding: 15px 0;
  transition: all var(--transition-normal);
}

.navbar.scrolled {
  padding: 10px 0;
  box-shadow: var(--shadow-lg);
}

.navbar-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.navbar-brand {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
}

.logo {
  width: 40px;
  height: 40px;
  background: var(--gradient-primary);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: 20px;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-normal);
}

.logo:hover {
  transform: rotate(5deg) scale(1.05);
}

.logo-text {
  font-size: 24px;
  font-weight: 800;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.nav-links {
  display: flex;
  gap: 20px;
  align-items: center;
}

.nav-link {
  font-weight: 600;
  color: var(--gray-700);
  padding: 8px 16px;
  border-radius: var(--radius-md);
  transition: all var(--transition-fast);
  position: relative;
  cursor: pointer;
}

.nav-link:hover {
  color: var(--primary);
  background-color: rgba(67, 97, 238, 0.1);
  transform: translateY(-1px);
}

.nav-link.active {
  color: white;
  background: var(--gradient-primary);
  box-shadow: var(--shadow-md);
}

.nav-link.active::after {
  content: '';
  position: absolute;
  bottom: -3px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  background-color: white;
  border-radius: var(--radius-round);
  animation: pulse 2s infinite;
}

/* 按钮样式 */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 24px;
  font-weight: 600;
  border-radius: var(--radius-md);
  border: none;
  cursor: pointer;
  transition: all var(--transition-normal);
  gap: 8px;
  white-space: nowrap;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn i {
  font-size: 14px;
  transition: transform var(--transition-fast);
}

.btn:hover i {
  transform: translateX(2px);
}

.btn-primary {
  background: var(--gradient-primary);
  color: white;
  box-shadow: var(--shadow-md);
}

.btn-secondary {
  background: var(--gradient-secondary);
  color: white;
  box-shadow: var(--shadow-md);
}

.btn-qpho {
  background: var(--gradient-qpho);
  color: white;
  box-shadow: var(--shadow-md);
}

.btn-outline {
  background: transparent;
  color: var(--primary);
  border: 2px solid var(--primary);
}

.btn-outline:hover {
  background: var(--primary);
  color: white;
}

.btn-sm {
  padding: 8px 16px;
  font-size: 14px;
}

.btn-icon {
  width: 40px;
  height: 40px;
  padding: 0;
  border-radius: var(--radius-round);
}

/* 表单控件 */
.form-control {
  padding: 12px 16px;
  border: 2px solid var(--gray-300);
  border-radius: var(--radius-md);
  font-size: 16px;
  transition: all var(--transition-normal);
  background-color: white;
}

.form-control:hover {
  border-color: var(--primary);
}

.form-control:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
  transform: translateY(-1px);
}

/* 自定义下拉箭头 */
select.form-control {
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%234361ee' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 16px;
  padding-right: 40px;
  cursor: pointer;
}

/* 主内容区域 */
.main-content {
  margin-top: 70px;
  padding: 40px 0;
  min-height: calc(100vh - 200px);
}

/* 页面切换 */
.page {
  display: none;
}

.page.active {
  display: block;
  animation: fadeIn 0.4s ease;
}

/* 英雄区域 */
.hero {
  padding: 80px 0;
  background: linear-gradient(135deg, rgba(67, 97, 238, 0.05) 0%, rgba(58, 12, 163, 0.05) 100%);
  border-radius: var(--radius-xl);
  margin-bottom: 60px;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.hero-title {
  font-size: 48px;
  margin-bottom: 20px;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  position: relative;
  z-index: 2;
}

.hero-subtitle {
  font-size: 20px;
  color: var(--gray-600);
  max-width: 700px;
  margin: 0 auto 40px;
  line-height: 1.6;
  position: relative;
  z-index: 2;
}

/* 统计卡片 */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 24px;
  margin-bottom: 60px;
}

.stat-card {
  background: white;
  border-radius: var(--radius-lg);
  padding: 30px;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-normal);
  position: relative;
  overflow: hidden;
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 6px;
  height: 100%;
  background: var(--gradient-primary);
}

.stat-icon {
  width: 60px;
  height: 60px;
  background: var(--gradient-primary);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 24px;
  margin-bottom: 20px;
  transition: transform var(--transition-normal);
}

.stat-card:hover .stat-icon {
  transform: rotate(5deg);
}

.stat-value {
  font-size: 36px;
  font-weight: 800;
  color: var(--gray-900);
  margin-bottom: 8px;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.stat-label {
  font-size: 16px;
  color: var(--gray-600);
  font-weight: 500;
}

/* 表格样式 */
.table-container {
  background: white;
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  margin-bottom: 40px;
}

.table-header {
  padding: 24px;
  border-bottom: 1px solid var(--gray-200);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.table-title {
  font-size: 20px;
  font-weight: 700;
  color: var(--gray-900);
  position: relative;
  display: flex;
  align-items: center;
  gap: 10px;
}

.table-title::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 0;
  width: 40px;
  height: 3px;
  background: var(--gradient-primary);
  border-radius: 2px;
}

.papers-table {
  width: 100%;
  border-collapse: collapse;
}

.papers-table th {
  padding: 16px 24px;
  text-align: left;
  background: var(--gray-100);
  color: var(--gray-700);
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 1px solid var(--gray-200);
}

.papers-table td {
  padding: 20px 24px;
  border-bottom: 1px solid var(--gray-200);
  vertical-align: middle;
  transition: background-color var(--transition-fast);
}

.papers-table tr:last-child td {
  border-bottom: none;
}

.papers-table tr:hover {
  background-color: rgba(67, 97, 238, 0.03);
}

.papers-table tr:hover td {
  border-color: rgba(67, 97, 238, 0.1);
}

/* 操作按钮容器 */
.action-buttons {
  display: flex;
  gap: 8px;
}

/* 搜索区域 */
.search-section {
  background: white;
  border-radius: var(--radius-lg);
  padding: 30px;
  box-shadow: var(--shadow-md);
  margin-bottom: 40px;
}

.search-title {
  font-size: 24px;
  margin-bottom: 24px;
  color: var(--gray-900);
  position: relative;
  display: flex;
  align-items: center;
  gap: 10px;
}

.search-title::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 0;
  width: 60px;
  height: 3px;
  background: var(--gradient-primary);
  border-radius: 2px;
}

.search-form {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.form-label {
  font-weight: 600;
  color: var(--gray-700);
  font-size: 14px;
}

/* 分类标签 */
.category-tag {
  display: inline-flex;
  align-items: center;
  padding: 4px 12px;
  background: rgba(67, 97, 238, 0.1);
  color: var(--primary);
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  transition: all var(--transition-normal);
}

.category-tag:hover {
  background: var(--primary);
  color: white;
  transform: translateY(-1px);
}

/* QPhO徽章 - 修复样式 */
.qpho-badge {
  display: inline-flex;
  align-items: center;
  padding: 4px 12px;
  background: var(--gradient-qpho);
  color: white;
  border-radius: 20px;
  font-weight: 600;
  font-size: 12px;
  white-space: nowrap;
}

.qpho-badge i {
  margin-right: 4px;
}

/* 标题容器 - 确保标题和徽章正确显示 */
.title-container {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

/* 模态框 */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(5px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-normal);
}

.modal.show {
  opacity: 1;
  visibility: visible;
}

.modal-content {
  background: white;
  border-radius: var(--radius-lg);
  width: 90%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
  transform: translateY(20px);
  transition: transform var(--transition-normal);
}

.modal.show .modal-content {
  transform: translateY(0);
}

.modal-header {
  padding: 24px;
  border-bottom: 1px solid var(--gray-200);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-title {
  font-size: 20px;
  font-weight: 700;
  color: var(--gray-900);
}

.modal-close {
  background: none;
  border: none;
  font-size: 20px;
  color: var(--gray-500);
  cursor: pointer;
  transition: color var(--transition-fast);
  width: 36px;
  height: 36px;
  border-radius: var(--radius-round);
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-close:hover {
  color: var(--danger);
  background: rgba(249, 65, 68, 0.1);
}

.modal-body {
  padding: 24px;
}

.modal-footer {
  padding: 20px 24px;
  border-top: 1px solid var(--gray-200);
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

/* 警告框 */
.alert {
  padding: 16px 20px;
  border-radius: var(--radius-md);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  position: relative;
}

.alert-success {
  background: rgba(76, 201, 240, 0.1);
  color: var(--success);
  border-left: 4px solid var(--success);
}

.alert-error {
  background: rgba(249, 65, 68, 0.1);
  color: var(--danger);
  border-left: 4px solid var(--danger);
}

.alert-info {
  background: rgba(67, 97, 238, 0.1);
  color: var(--primary);
  border-left: 4px solid var(--primary);
}

.alert-warning {
  background: rgba(248, 150, 30, 0.1);
  color: var(--warning);
  border-left: 4px solid var(--warning);
}

/* 页脚 */
.footer {
  background: var(--gradient-dark);
  color: white;
  padding: 60px 0 30px;
  margin-top: 80px;
}

.footer-content {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 40px;
  margin-bottom: 40px;
}

.footer-section-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 20px;
  color: white;
}

.footer-links {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.footer-link {
  color: var(--gray-300);
  transition: color var(--transition-fast);
  cursor: pointer;
}

.footer-link:hover {
  color: white;
}

.footer-bottom {
  text-align: center;
  padding-top: 30px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--gray-400);
  font-size: 14px;
}

/* 空状态 */
.empty-state {
  text-align: center;
  padding: 60px 20px;
}

.empty-state-icon {
  font-size: 64px;
  color: var(--gray-300);
  margin-bottom: 20px;
}

.empty-state-title {
  font-size: 24px;
  color: var(--gray-700);
  margin-bottom: 12px;
}

.empty-state-description {
  color: var(--gray-600);
  max-width: 400px;
  margin: 0 auto 30px;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .navbar-container {
    flex-direction: column;
    gap: 20px;
  }
  
  .nav-links {
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
  
  .hero-title {
    font-size: 36px;
  }
  
  .hero-subtitle {
    font-size: 18px;
  }
  
  .table-header {
    flex-direction: column;
    gap: 20px;
    align-items: flex-start;
  }
  
  .search-form {
    grid-template-columns: 1fr;
  }
  
  .action-buttons {
    flex-direction: column;
    width: 100%;
  }
  
  .action-buttons .btn {
    width: 100%;
    margin-bottom: 5px;
  }
  
  .title-container {
    flex-direction: column;
    align-items: flex-start;
  }
}

/* 工具类 */
.d-none {
  display: none !important;
}

.d-flex {
  display: flex !important;
}

.justify-between {
  justify-content: space-between;
}

.align-center {
  align-items: center;
}

.text-center {
  text-align: center;
}

.mb-20 {
  margin-bottom: 20px;
}

.mb-40 {
  margin-bottom: 40px;
}

.mt-20 {
  margin-top: 20px;
}

.mt-40 {
  margin-top: 40px;
}

.w-100 {
  width: 100%;
}

.gap-10 {
  gap: 10px;
}

.gap-15 {
  gap: 15px;
}

.gap-20 {
  gap: 20px;
}

.justify-center {
  justify-content: center;
}

/* 加载指示器 */
.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--gray-200);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 16px;
}

.loading-text {
  color: var(--gray-600);
  font-size: 16px;
}

/* 数据源指示器 */
.data-source-info {
  background: rgba(67, 97, 238, 0.05);
  border: 1px solid rgba(67, 97, 238, 0.2);
  border-radius: var(--radius-md);
  padding: 12px 16px;
  margin-top: 20px;
  font-size: 14px;
  color: var(--gray-600);
}

.data-source-info i {
  color: var(--primary);
  margin-right: 8px;
}
</style>
</head>
<body>
<!-- 顶部导航栏 -->
<nav class="navbar">
  <div class="container navbar-container">
    <div class="navbar-brand">
      <div class="logo animate-pulse">Q</div>
      <div class="logo-text">QPhO Papers</div>
    </div>
    <ul class="nav-links">
      <li><a href="#" class="nav-link active" data-page="home">首页</a></li>
      <li><a href="#" class="nav-link" data-page="papers">试卷库</a></li>
      <li><a href="#" class="nav-link" data-page="qpho">QPhO专区</a></li>
      <li><a href="#" class="nav-link" data-page="about">关于</a></li>
    </ul>
  </div>
</nav>

<!-- 主内容区域 -->
<main class="main-content">
  <div class="container">
    <!-- 首页 -->
    <div id="home-page" class="page active">
      <div class="hero animate-fade-in">
        <h1 class="hero-title animate-fade-up">物理奥林匹克试卷库</h1>
        <p class="hero-subtitle animate-fade-up" style="animation-delay: 0.1s;">
          收集全球物理奥林匹克竞赛试卷，提供高质量的学习资源，助力物理竞赛备考和教学研究
        </p>
        <div class="d-flex justify-center align-center gap-20 animate-fade-up" style="animation-delay: 0.2s;">
          <button class="btn btn-primary" data-page="papers">
            <i class="fas fa-book-open"></i>
            浏览试卷
          </button>
          <button class="btn btn-qpho" data-page="qpho">
            <i class="fas fa-bolt"></i>
            QPhO专区
          </button>
        </div>
      </div>
      <div id="stats-container">
        <div class="stats-grid">
          <div class="stat-card animate-slide-left">
            <div class="stat-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <div class="stat-value" id="total-papers">0</div>
            <div class="stat-label">总试卷数量</div>
          </div>
          <div class="stat-card animate-fade-up" style="animation-delay: 0.1s;">
            <div class="stat-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-value" id="total-years">0</div>
            <div class="stat-label">年份跨度</div>
          </div>
          <div class="stat-card animate-fade-up" style="animation-delay: 0.2s;">
            <div class="stat-icon">
              <i class="fas fa-tags"></i>
            </div>
            <div class="stat-value" id="total-categories">0</div>
            <div class="stat-label">分类数量</div>
          </div>
          <div class="stat-card animate-slide-right" style="animation-delay: 0.3s;">
            <div class="stat-icon">
              <i class="fas fa-star"></i>
            </div>
            <div class="stat-value" id="qpho-count">0</div>
            <div class="stat-label">QPhO试卷</div>
          </div>
        </div>
      </div>
      <div class="table-container animate-fade-up" style="animation-delay: 0.3s;">
        <div class="table-header">
          <div class="title-container">
            <h2 class="table-title">最新试卷</h2>
          </div>
          <div class="d-flex gap-15">
            <a href="#" class="btn btn-outline btn-sm" data-page="papers">
              查看全部
              <i class="fas fa-arrow-right"></i>
            </a>
            <a href="#" class="btn btn-qpho btn-sm" data-page="qpho">
              <i class="fas fa-bolt"></i>
              QPhO专区
            </a>
          </div>
        </div>
        <div id="recent-papers-table">
          <div class="loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">正在加载试卷数据...</div>
          </div>
        </div>
      </div>
    </div>

    <!-- 试卷库页面 -->
    <div id="papers-page" class="page">
      <div class="search-section animate-fade-in">
        <div class="title-container">
          <h2 class="search-title">试卷库</h2>
          <span class="qpho-badge animate-pulse">
            <i class="fas fa-bolt"></i>
            专业资源
          </span>
        </div>
        <div class="search-form">
          <div class="form-group">
            <label class="form-label">搜索关键词</label>
            <input type="text" class="form-control" id="paper-search" placeholder="试卷名称、描述或标签">
          </div>
          <div class="form-group">
            <label class="form-label">竞赛分类</label>
            <select class="form-control" id="paper-category">
              <option value="">所有分类</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">年份</label>
            <select class="form-control" id="paper-year">
              <option value="">所有年份</option>
            </select>
          </div>
        </div>
        <div class="d-flex justify-between align-center">
          <button class="btn btn-primary" id="search-papers-btn">
            <i class="fas fa-search"></i>
            搜索试卷
          </button>
          <button class="btn btn-outline" id="reset-search-btn">
            <i class="fas fa-redo"></i>
            重置
          </button>
        </div>
        <div id="data-source-info" class="data-source-info d-none">
          <i class="fas fa-database"></i>
          <span>数据源：data.txt + category.txt + QPhO.txt | 共加载了<span id="loaded-papers-count">0</span>份试卷</span>
        </div>
      </div>
      <div class="table-container animate-fade-up" style="animation-delay: 0.2s;">
        <table class="papers-table" id="papers-table">
          <thead>
            <tr>
              <th>试卷名称</th>
              <th>年份</th>
              <th>分类</th>
              <th>发布日期</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="papers-table-body">
            <tr>
              <td colspan="5" style="text-align: center; padding: 40px;">
                <div class="loading">
                  <div class="loading-spinner"></div>
                  <div class="loading-text">正在加载试卷数据...</div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- QPhO专区页面 -->
    <div id="qpho-page" class="page">
      <div class="hero animate-fade-in">
        <div class="title-container" style="justify-content: center; margin-bottom: 10px;">
          <h1 class="hero-title animate-fade-up">QPhO物理竞赛专区</h1>
          <span class="qpho-badge animate-pulse" style="font-size: 14px;">
            <i class="fas fa-bolt"></i>
            独家资源
          </span>
        </div>
        <p class="hero-subtitle animate-fade-up" style="animation-delay: 0.1s;">
          QPhO（Quantum Physics Olympiad）专属试卷库，收录高质量模拟试题和真题
        </p>
        <div class="d-flex justify-center align-center gap-20 animate-fade-up" style="animation-delay: 0.2s;">
          <button class="btn btn-qpho" id="view-all-qpho">
            <i class="fas fa-book"></i>
            查看所有QPhO试卷
          </button>
        </div>
      </div>
      <div class="search-section mb-40 animate-fade-up" style="animation-delay: 0.2s;">
        <div class="title-container">
          <h2 class="search-title">QPhO试卷库</h2>
          <span class="qpho-badge">
            <i class="fas fa-star"></i>
            精选
          </span>
        </div>
        <div class="d-flex justify-between align-center mb-20">
          <div class="d-flex gap-15">
            <button class="btn btn-qpho btn-sm" id="qpho-search-btn">
              <i class="fas fa-search"></i>
              搜索QPhO试卷
            </button>
            <button class="btn btn-outline btn-sm" id="qpho-reset-btn">
              <i class="fas fa-filter"></i>
              重置筛选
            </button>
          </div>
          <div id="qpho-stats" class="d-flex align-center gap-20">
            <div class="text-center">
              <div class="stat-value" id="qpho-total">0</div>
              <div class="stat-label">试卷总数</div>
            </div>
            <div class="text-center">
              <div class="stat-value" id="qpho-years">0</div>
              <div class="stat-label">年份跨度</div>
            </div>
          </div>
        </div>
        <div class="table-container">
          <table class="papers-table" id="qpho-table">
            <thead>
              <tr>
                <th>试卷名称</th>
                <th>年份</th>
                <th>试卷类型</th>
                <th>难度</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody id="qpho-table-body">
              <tr>
                <td colspan="5" style="text-align: center; padding: 40px;">
                  <div class="loading">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">正在加载QPhO试卷数据...</div>
                  </div>
                </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="stats-grid">
        <div class="stat-card animate-slide-left">
          <div class="stat-icon" style="background: var(--gradient-qpho);">
            <i class="fas fa-bolt"></i>
          </div>
          <div class="stat-value" style="background: var(--gradient-qpho);" id="qpho-simulated">0</div>
          <div class="stat-label">模拟试卷</div>
        </div>
        <div class="stat-card animate-fade-up" style="animation-delay: 0.1s;">
          <div class="stat-icon" style="background: var(--gradient-qpho);">
            <i class="fas fa-trophy"></i>
          </div>
          <div class="stat-value" style="background: var(--gradient-qpho);" id="qpho-final">0</div>
          <div class="stat-label">决赛试卷</div>
        </div>
        <div class="stat-card animate-fade-up" style="animation-delay: 0.2s;">
          <div class="stat-icon" style="background: var(--gradient-qpho);">
            <i class="fas fa-file-contract"></i>
          </div>
          <div class="stat-value" style="background: var(--gradient-qpho);" id="qpho-preliminary">0</div>
          <div class="stat-label">初赛试卷</div>
        </div>
        <div class="stat-card animate-slide-right" style="animation-delay: 0.3s;">
          <div class="stat-icon" style="background: var(--gradient-qpho);">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="stat-value" style="background: var(--gradient-qpho);" id="qpho-latest">2025</div>
          <div class="stat-label">最新年份</div>
        </div>
      </div>
    </div>

    <!-- 关于页面 -->
    <div id="about-page" class="page">
      <div class="hero">
        <h1 class="hero-title animate-fade-up">关于 QPhO Papers</h1>
        <p class="hero-subtitle animate-fade-up" style="animation-delay: 0.1s;">
          一个致力于物理教育资源共享的开源项目
        </p>
      </div>
      <div class="search-section mb-40">
        <div class="title-container">
          <h2 class="search-title">项目简介</h2>
        </div>
        <p style="color: var(--gray-600); line-height: 1.8; margin-bottom: 20px;">
          QPhO Papers 是一个专注于收集、整理和管理全球物理奥林匹克竞赛试卷的开源平台。我们的使命是为物理学习者、教师和研究人员提供高质量、系统化的竞赛资源，助力物理教育的发展和学术研究的进步。
        </p>
        <p style="color: var(--gray-600); line-height: 1.8;">
          平台采用现代化的Web技术构建，具有响应式设计、直观的用户界面和强大的搜索功能。所有数据来源于公开资源，持续更新维护。
        </p>
      </div>
      <div class="stats-grid">
        <div class="stat-card animate-slide-left">
          <div class="stat-icon">
            <i class="fas fa-code-branch"></i>
          </div>
          <div class="stat-value">开源</div>
          <div class="stat-label">完全开源项目</div>
        </div>
        <div class="stat-card animate-fade-up" style="animation-delay: 0.1s;">
          <div class="stat-icon">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-value">社区驱动</div>
          <div class="stat-label">由社区共同维护</div>
        </div>
        <div class="stat-card animate-fade-up" style="animation-delay: 0.2s;">
          <div class="stat-icon">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <div class="stat-value">教育公益</div>
          <div class="stat-label">专注于教育公益</div>
        </div>
        <div class="stat-card animate-slide-right" style="animation-delay: 0.3s;">
          <div class="stat-icon">
            <i class="fas fa-sync-alt"></i>
          </div>
          <div class="stat-value">持续更新</div>
          <div class="stat-label">定期更新和维护</div>
        </div>
      </div>
      <div class="search-section mt-40">
        <div class="title-container">
          <h2 class="search-title">数据来源</h2>
        </div>
        <p style="color: var(--gray-600); line-height: 1.8; margin-bottom: 20px;">
          所有试卷数据来源于三个数据文件：
        </p>
        <div class="alert alert-info mt-20">
          <i class="fas fa-info-circle"></i>
          <span>
            <strong>data.txt</strong> - 主要试卷数据<br>
            <strong>category.txt</strong> - 分类数据<br>
            <strong>QPhO.txt</strong> - QPhO专区数据
          </span>
        </div>
        <div class="mt-20">
          <h3 class="search-title" style="font-size: 18px;">文件格式示例：</h3>
          <pre style="background: var(--gray-100); padding: 15px; border-radius: var(--radius-md); overflow-x: auto; margin-top: 10px; font-size: 14px;">
# data.txt 格式
试卷名称 年份.月份.日期 分类ID 链接

# category.txt 格式
1.CPhO复赛真题卷
2.CPhO决赛真题卷

# QPhO.txt 格式
试卷名称 年份.月份.日期 链接</pre>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- 页脚 -->
<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div>
        <h3 class="footer-section-title">QPhO Papers</h3>
        <p style="color: var(--gray-300); margin-bottom: 20px;">
          物理奥林匹克试卷资源库，为物理学习者提供高质量的学习资源。
        </p>
        <div class="d-flex gap-15">
          <a href="#" class="footer-link">
            <i class="fab fa-github"></i>
          </a>
          <a href="#" class="footer-link">
            <i class="fab fa-twitter"></i>
          </a>
          <a href="#" class="footer-link">
            <i class="fab fa-discord"></i>
          </a>
        </div>
      </div>
      <div>
        <h3 class="footer-section-title">快速链接</h3>
        <ul class="footer-links">
          <li><a href="#" class="footer-link" data-page="home">首页</a></li>
          <li><a href="#" class="footer-link" data-page="papers">试卷库</a></li>
          <li><a href="#" class="footer-link" data-page="qpho">QPhO专区</a></li>
          <li><a href="#" class="footer-link" data-page="about">关于</a></li>
        </ul>
      </div>
      <div>
        <h3 class="footer-section-title">热门分类</h3>
        <ul class="footer-links">
          <li><a href="#" class="footer-link" data-category="CPhO复赛真题卷">CPhO复赛真题卷</a></li>
          <li><a href="#" class="footer-link" data-category="CPhO决赛真题卷">CPhO决赛真题卷</a></li>
          <li><a href="#" class="footer-link" data-category="IPhO国际物理奥林匹克">国际物理奥林匹克</a></li>
          <li><a href="#" class="footer-link" data-category="APhO亚洲物理奥林匹克">亚洲物理奥林匹克</a></li>
        </ul>
      </div>
      <div>
        <h3 class="footer-section-title">支持我们</h3>
        <ul class="footer-links">
          <li><a href="mailto:contact@qpho-papers.org" class="footer-link">contact@qpho-papers.org</a></li>
          <li><a href="#" class="footer-link">贡献指南</a></li>
          <li><a href="#" class="footer-link">数据提交</a></li>
          <li><a href="#" class="footer-link">问题反馈</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2024 QPhO Papers. 保留所有权利。 | 一个开源物理教育项目</p>
      <p style="margin-top: 10px; font-size: 12px; color: var(--gray-500);">
        最后更新: <span id="last-update">2024年12月</span> | 数据版本: <span id="data-version">v2.0</span>
      </p>
    </div>
  </div>
</footer>

<!-- 下载确认模态框 -->
<div id="download-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">确认下载</h3>
      <button class="modal-close" id="close-download-modal">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <p>您即将下载试卷：<strong id="download-paper-name"></strong></p>
      <div class="alert alert-info mt-20">
        <i class="fas fa-info-circle"></i>
        <span>请注意：部分试卷链接可能指向外部网站，请确保您信任该来源。</span>
      </div>
      <div class="mt-20" style="font-size: 14px; color: var(--gray-600);">
        <p>下载链接：</p>
        <code id="download-paper-url" style="display: block; padding: 10px; background: var(--gray-100); border-radius: var(--radius-md); margin-top: 5px; word-break: break-all;"></code>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" id="cancel-download">取消</button>
      <a href="#" target="_blank" class="btn btn-primary" id="confirm-download-link">确认下载</a>
    </div>
  </div>
</div>

<!-- 试卷详情模态框 -->
<div id="paper-details-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title" id="paper-details-title">试卷详情</h3>
      <button class="modal-close" id="close-paper-details">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body" id="paper-details-content">
      <!-- 动态加载 -->
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" id="close-details-modal">关闭</button>
      <a href="#" target="_blank" class="btn btn-primary" id="paper-download-btn">下载试卷</a>
    </div>
  </div>
</div>

<script>
// 应用程序状态管理
const QPHO = {
  // 状态变量
  state: {
    papers: [],
    qphoPapers: [],
    categories: new Map(),
    currentPage: 'home',
    selectedPaperId: null,
    isLoading: true,
    dataSource: 'none',
    years: new Set(),
    qphoYears: new Set()
  },
  
  // 初始化应用程序
  async init() {
    this.initEventListeners();
    this.showLoading();
    await this.loadAllData();
    this.initUI();
    this.showPage('home');
    this.updateStats();
    this.hideLoading();
    this.showDataSourceInfo();
  },
  
  // 加载所有数据
  async loadAllData() {
    try {
      this.state.isLoading = true;
      
      // 并行加载所有数据文件
      const [papersData, categoriesData, qphoData] = await Promise.allSettled([
        this.loadDataFile('/QPhO/data.txt'),
        this.loadDataFile('/QPhO/category.txt'),
        this.loadDataFile('/QPhO/QPhO.txt')
      ]);
      
      // 解析分类数据
      if (categoriesData.status === 'fulfilled' && categoriesData.value) {
        this.parseCategoriesData(categoriesData.value);
      } else {
        // 如果分类文件不存在，使用默认分类
        this.state.categories.set('1', 'CPhO复赛真题卷');
        this.state.categories.set('2', 'CPhO决赛真题卷');
      }
      
      // 解析主要试卷数据
      if (papersData.status === 'fulfilled' && papersData.value) {
        const papers = this.parsePapersData(papersData.value);
        this.state.papers = papers;
        this.updateCollections(papers);
      }
      
      // 解析QPhO数据
      if (qphoData.status === 'fulfilled' && qphoData.value) {
        const qphoPapers = this.parseQphoData(qphoData.value);
        this.state.qphoPapers = qphoPapers;
        this.updateQphoCollections(qphoPapers);
      }
      
      this.state.dataSource = 'files';
      
      console.log(`加载了${this.state.papers.length}份普通试卷，${this.state.qphoPapers.length}份QPhO试卷`);
      
    } catch (error) {
      console.error('加载数据失败:', error);
      this.showError('无法加载数据文件，请确保文件存在且格式正确。');
    } finally {
      this.state.isLoading = false;
    }
  },
  
  // 加载数据文件
  async loadDataFile(url) {
    try {
      const response = await fetch(url, {
        cache: 'no-cache',
        headers: {
          'Content-Type': 'text/plain; charset=utf-8'
        }
      });
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      return await response.text();
      
    } catch (error) {
      console.warn(`加载文件失败: ${url}`, error);
      return null;
    }
  },
  
  // 解析分类数据
  parseCategoriesData(text) {
    const categories = new Map();
    const lines = text.trim().split('\n');
    
    lines.forEach(line => {
      const trimmedLine = line.trim();
      if (!trimmedLine) return;
      
      // 格式: id.name
      const parts = trimmedLine.split('.');
      if (parts.length >= 2) {
        const id = parts[0];
        const name = parts.slice(1).join('.');
        categories.set(id, name);
      }
    });
    
    this.state.categories = categories;
  },
  
  // 解析主要试卷数据
  parsePapersData(text) {
    const papers = [];
    const lines = text.trim().split('\n');
    
    lines.forEach((line, index) => {
      const trimmedLine = line.trim();
      if (!trimmedLine) return;
      
      try {
        // 解析格式：试卷名称 年份.月份.日期 分类ID 链接
        const parts = trimmedLine.split(' ');
        
        if (parts.length >= 4) {
          // 查找日期部分（格式：YYYY.MM.DD）
          let dateIndex = -1;
          let dateStr = '';
          for (let i = 0; i < parts.length; i++) {
            if (parts[i].match(/\d{4}\.\d{1,2}\.\d{1,2}/)) {
              dateIndex = i;
              dateStr = parts[i];
              break;
            }
          }
          
          if (dateIndex > 0) {
            const name = parts.slice(0, dateIndex).join(' ');
            const categoryId = parts[dateIndex + 1];
            const url = parts.slice(dateIndex + 2).join(' ');
            
            // 解析日期
            const [year, month, day] = dateStr.split('.').map(Number);
            
            // 获取分类名称
            let category = '其他竞赛';
            if (this.state.categories.has(categoryId)) {
              category = this.state.categories.get(categoryId);
            } else if (categoryId.includes('.')) {
              const catId = categoryId.split('.')[0];
              category = this.state.categories.get(catId) || categoryId;
            }
            
            // 格式化日期
            const formattedDate = `${year}年${month}月${day}日`;
            
            papers.push({
              id: `paper_${index + 1}`,
              name: name,
              year: year,
              month: month,
              day: day,
              date: formattedDate,
              fullDate: dateStr,
              category: category,
              categoryId: categoryId,
              url: url.startsWith('http') ? url : 'https://' + url,
              description: `${name}，发布于${formattedDate}。这是一份高质量的物理奥林匹克竞赛试卷，适用于物理竞赛备考和教学研究。`,
              type: name.includes('模拟') ? '模拟卷' : 
                    name.includes('决赛') ? '决赛卷' : 
                    name.includes('复赛') ? '复赛卷' : '真题卷',
              difficulty: '中等',
              added: new Date().toISOString().split('T')[0],
              source: 'data.txt'
            });
          }
        }
      } catch (error) {
        console.warn(`解析试卷数据失败 (行${index + 1}): ${trimmedLine}`, error);
      }
    });
    
    return papers;
  },
  
  // 解析QPhO数据
  parseQphoData(text) {
    const papers = [];
    const lines = text.trim().split('\n');
    
    lines.forEach((line, index) => {
      const trimmedLine = line.trim();
      if (!trimmedLine) return;
      
      try {
        // 解析格式：试卷名称 年份.月份.日期 链接
        const parts = trimmedLine.split(' ');
        
        if (parts.length >= 3) {
          // 查找日期部分
          let dateIndex = -1;
          let dateStr = '';
          for (let i = 0; i < parts.length; i++) {
            if (parts[i].match(/\d{4}\.\d{1,2}\.\d{1,2}/)) {
              dateIndex = i;
              dateStr = parts[i];
              break;
            }
          }
          
          if (dateIndex > 0) {
            const name = parts.slice(0, dateIndex).join(' ');
            const url = parts.slice(dateIndex + 1).join(' ');
            
            // 解析日期
            const [year, month, day] = dateStr.split('.').map(Number);
            
            // 确定试卷类型
            let type = '模拟卷';
            let difficulty = '中等';
            
            if (name.includes('决赛')) {
              type = '决赛卷';
              difficulty = '困难';
            } else if (name.includes('复赛')) {
              type = '复赛卷';
              difficulty = '中等';
            } else if (name.includes('初赛')) {
              type = '初赛卷';
              difficulty = '简单';
            }
            
            // 格式化日期
            const formattedDate = `${year}年${month}月${day}日`;
            
            papers.push({
              id: `qpho_${index + 1}`,
              name: name,
              year: year,
              month: month,
              day: day,
              date: formattedDate,
              fullDate: dateStr,
              category: 'QPhO物理竞赛',
              url: url.startsWith('http') ? url : 'https://' + url,
              description: `${name}，发布于${formattedDate}。这是QPhO（Quantum Physics Olympiad）的专属试卷，包含高质量的物理竞赛试题。`,
              type: type,
              difficulty: difficulty,
              added: new Date().toISOString().split('T')[0],
              source: 'QPhO.txt',
              isQpho: true
            });
          }
        }
      } catch (error) {
        console.warn(`解析QPhO数据失败 (行${index + 1}): ${trimmedLine}`, error);
      }
    });
    
    return papers;
  },
  
  // 更新集合数据
  updateCollections(papers) {
    this.state.years.clear();
    papers.forEach(paper => {
      this.state.years.add(paper.year);
    });
  },
  
  // 更新QPhO集合数据
  updateQphoCollections(qphoPapers) {
    this.state.qphoYears.clear();
    qphoPapers.forEach(paper => {
      this.state.qphoYears.add(paper.year);
    });
  },
  
  // 显示错误信息
  showError(message) {
    const createErrorHTML = (message) => `
      <div class="empty-state">
        <div class="empty-state-icon">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h3 class="empty-state-title">加载失败</h3>
        <p class="empty-state-description">${message}</p>
        <button class="btn btn-primary" onclick="QPHO.init()">
          <i class="fas fa-redo"></i>
          重新加载
        </button>
      </div>
    `;
    
    // 首页表格
    const homeTable = document.getElementById('recent-papers-table');
    if (homeTable) {
      homeTable.innerHTML = createErrorHTML(message);
    }
    
    // 试卷库表格
    const papersTable = document.getElementById('papers-table-body');
    if (papersTable) {
      papersTable.innerHTML = `
        <tr>
          <td colspan="5" style="text-align: center; padding: 40px;">
            ${createErrorHTML(message)}
          </td>
        </tr>
      `;
    }
    
    // QPhO表格
    const qphoTable = document.getElementById('qpho-table-body');
    if (qphoTable) {
      qphoTable.innerHTML = `
        <tr>
          <td colspan="5" style="text-align: center; padding: 40px;">
            ${createErrorHTML(message)}
          </td>
        </tr>
      `;
    }
  },
  
  // 初始化事件监听器
  initEventListeners() {
    // 导航链接点击
    document.querySelectorAll('[data-page]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const page = link.getAttribute('data-page');
        this.showPage(page);
        
        // 更新导航状态
        document.querySelectorAll('.nav-link').forEach(item => {
          item.classList.remove('active');
        });
        if (link.classList.contains('nav-link')) {
          link.classList.add('active');
        }
      });
    });
    
    // 页脚分类链接
    document.querySelectorAll('[data-category]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const category = link.getAttribute('data-category');
        this.showPage('papers');
        document.getElementById('paper-category').value = category;
        this.searchPapers();
      });
    });
    
    // 模态框关闭
    document.getElementById('close-download-modal').addEventListener('click', () => {
      this.hideModal('download-modal');
    });
    
    document.getElementById('cancel-download').addEventListener('click', () => {
      this.hideModal('download-modal');
    });
    
    document.getElementById('close-paper-details').addEventListener('click', () => {
      this.hideModal('paper-details-modal');
    });
    
    document.getElementById('close-details-modal').addEventListener('click', () => {
      this.hideModal('paper-details-modal');
    });
    
    // 搜索按钮
    document.getElementById('search-papers-btn').addEventListener('click', () => {
      this.searchPapers();
    });
    
    document.getElementById('reset-search-btn').addEventListener('click', () => {
      this.resetSearch();
    });
    
    // QPhO按钮
    document.getElementById('view-all-qpho')?.addEventListener('click', () => {
      this.showPage('qpho');
    });
    
    document.getElementById('qpho-search-btn')?.addEventListener('click', () => {
      this.searchQphoPapers();
    });
    
    document.getElementById('qpho-reset-btn')?.addEventListener('click', () => {
      this.resetQphoSearch();
    });
    
    // 滚动监听
    window.addEventListener('scroll', () => {
      const navbar = document.querySelector('.navbar');
      if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
      } else {
        navbar.classList.remove('scrolled');
      }
    });
    
    // 点击外部关闭模态框
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal')) {
        const modalId = e.target.id;
        this.hideModal(modalId);
      }
    });
  },
  
  // 初始化UI
  initUI() {
    this.initFilters();
    this.updateLastUpdate();
  },
  
  // 更新最后更新时间
  updateLastUpdate() {
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth() + 1;
    const day = now.getDate();
    
    document.getElementById('last-update').textContent = `${year}年${month}月${day}日`;
    document.getElementById('data-version').textContent = 'v2.0';
  },
  
  // 初始化筛选器
  initFilters() {
    this.initCategoryFilter();
    this.initYearFilter();
  },
  
  // 初始化分类筛选器
  initCategoryFilter() {
    const categoryFilter = document.getElementById('paper-category');
    
    // 清空现有选项
    categoryFilter.innerHTML = '<option value="">所有分类</option>';
    
    // 收集所有分类
    const categories = new Set();
    this.state.papers.forEach(paper => {
      categories.add(paper.category);
    });
    
    // 添加分类选项
    Array.from(categories).sort().forEach(category => {
      const option = document.createElement('option');
      option.value = category;
      option.textContent = category;
      categoryFilter.appendChild(option);
    });
  },
  
  // 初始化年份筛选器
  initYearFilter() {
    const yearFilter = document.getElementById('paper-year');
    yearFilter.innerHTML = '<option value="">所有年份</option>';
    
    if (this.state.years.size > 0) {
      const years = Array.from(this.state.years).sort((a, b) => b - a);
      years.forEach(year => {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearFilter.appendChild(option);
      });
    }
  },
  
  // 显示加载状态
  showLoading() {
    // 不需要特别处理
  },
  
  // 隐藏加载状态
  hideLoading() {
    // 不需要特别处理
  },
  
  // 显示数据源信息
  showDataSourceInfo() {
    const infoElement = document.getElementById('data-source-info');
    const countElement = document.getElementById('loaded-papers-count');
    
    if (infoElement && countElement) {
      const totalPapers = this.state.papers.length + this.state.qphoPapers.length;
      countElement.textContent = totalPapers;
      
      infoElement.innerHTML = `
        <i class="fas fa-database"></i>
        <span>
          数据源：data.txt + category.txt + QPhO.txt | 
          共加载了${totalPapers}份试卷
          (普通:${this.state.papers.length} QPhO:${this.state.qphoPapers.length})
        </span>
      `;
      infoElement.classList.remove('d-none');
    }
  },
  
  // 显示页面
  showPage(pageName) {
    // 隐藏所有页面
    document.querySelectorAll('.page').forEach(page => {
      page.classList.remove('active');
    });
    
    // 显示目标页面
    const targetPage = document.getElementById(`${pageName}-page`);
    if (targetPage) {
      targetPage.classList.add('active');
      this.state.currentPage = pageName;
      
      // 页面特定初始化
      switch (pageName) {
        case 'home':
          if (!this.state.isLoading) {
            this.renderRecentPapers();
            this.updateStats();
          }
          break;
        case 'papers':
          if (!this.state.isLoading) {
            this.renderPapersTable();
          }
          break;
        case 'qpho':
          if (!this.state.isLoading) {
            this.renderQphoTable();
            this.updateQphoStats();
          }
          break;
      }
    }
    
    // 更新导航栏活动状态
    document.querySelectorAll('.nav-link').forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('data-page') === pageName) {
        link.classList.add('active');
      }
    });
    
    // 滚动到顶部
    window.scrollTo({ top: 0, behavior: 'smooth' });
  },
  
  // 显示模态框
  showModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.add('show');
      document.body.style.overflow = 'hidden';
    }
  },
  
  // 隐藏模态框
  hideModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove('show');
      document.body.style.overflow = 'auto';
    }
  },
  
  // 显示下载确认模态框
  showDownloadModal(paperId) {
    const allPapers = [...this.state.papers, ...this.state.qphoPapers];
    const paper = allPapers.find(p => p.id === paperId);
    if (!paper) return;
    
    document.getElementById('download-paper-name').textContent = paper.name;
    document.getElementById('download-paper-url').textContent = paper.url;
    
    // 设置下载链接
    const downloadLink = document.getElementById('confirm-download-link');
    downloadLink.href = paper.url;
    downloadLink.setAttribute('target', '_blank');
    
    this.state.selectedPaperId = paperId;
    this.showModal('download-modal');
  },
  
  // 显示试卷详情模态框
  showPaperDetails(paperId) {
    const allPapers = [...this.state.papers, ...this.state.qphoPapers];
    const paper = allPapers.find(p => p.id === paperId);
    if (!paper) return;
    
    document.getElementById('paper-details-title').textContent = paper.name;
    
    let html = `
      <div style="margin-bottom: 20px;">
        <span class="category-tag">${paper.category}</span>
        <span style="margin-left: 10px; color: var(--gray-600);">
          <i class="fas fa-calendar-alt"></i> ${paper.year}年
        </span>
        ${paper.isQpho ? '<span class="qpho-badge" style="margin-left: 10px;">QPhO</span>' : ''}
      </div>
      <p style="margin-bottom: 10px; color: var(--gray-700);">
        <strong>试卷类型：</strong>${paper.type}
      </p>
      <p style="margin-bottom: 10px; color: var(--gray-700);">
        <strong>发布日期：</strong>${paper.date}
      </p>
      <p style="margin-bottom: 10px; color: var(--gray-700);">
        <strong>难度：</strong>${paper.difficulty}
      </p>
      <p style="margin-bottom: 20px; color: var(--gray-700); line-height: 1.6;">
        ${paper.description}
      </p>
      <div class="alert alert-info">
        <i class="fas fa-link"></i>
        <span>试卷链接：<a href="${paper.url}" target="_blank">${paper.url}</a></span>
      </div>
    `;
    
    document.getElementById('paper-details-content').innerHTML = html;
    document.getElementById('paper-download-btn').href = paper.url;
    this.showModal('paper-details-modal');
  },
  
  // 搜索试卷
  searchPapers() {
    const searchTerm = document.getElementById('paper-search').value.toLowerCase();
    const category = document.getElementById('paper-category').value;
    const year = document.getElementById('paper-year').value;
    
    this.renderPapersTable(searchTerm, category, year);
  },
  
  // 搜索QPhO试卷
  searchQphoPapers() {
    // 这里可以添加QPhO特定的搜索逻辑
    this.renderQphoTable();
  },
  
  // 重置搜索
  resetSearch() {
    document.getElementById('paper-search').value = '';
    document.getElementById('paper-category').value = '';
    document.getElementById('paper-year').value = '';
    this.renderPapersTable();
  },
  
  // 重置QPhO搜索
  resetQphoSearch() {
    this.renderQphoTable();
  },
  
  // 渲染最新试卷
  renderRecentPapers() {
    const container = document.getElementById('recent-papers-table');
    
    if (this.state.isLoading) {
      return;
    }
    
    const allPapers = [...this.state.papers, ...this.state.qphoPapers];
    
    if (allPapers.length === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">
            <i class="fas fa-book-open"></i>
          </div>
          <h3 class="empty-state-title">暂无试卷数据</h3>
          <p class="empty-state-description">请确保数据文件存在且格式正确。</p>
        </div>
      `;
      return;
    }
    
    const recentPapers = allPapers
      .sort((a, b) => {
        if (b.year !== a.year) return b.year - a.year;
        if (b.month !== a.month) return b.month - a.month;
        return b.day - a.day;
      })
      .slice(0, 5);
    
    let html = `
      <table class="papers-table">
        <thead>
          <tr>
            <th>试卷名称</th>
            <th>年份</th>
            <th>分类</th>
            <th>试卷类型</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
    `;
    
    recentPapers.forEach((paper, index) => {
      html += `
        <tr data-id="${paper.id}">
          <td>
            <div style="display: flex; align-items: center;">
              <a href="#" class="paper-title" style="font-weight: 600; color: var(--gray-900);">${paper.name}</a>
              ${paper.isQpho ? '<span class="qpho-badge" style="margin-left: 8px;">QPhO</span>' : ''}
            </div>
            <div style="font-size: 14px; color: var(--gray-600); margin-top: 4px;">
              ${paper.description.substring(0, 60)}...
            </div>
          </td>
          <td>${paper.year}</td>
          <td>${paper.category}</td>
          <td>${paper.type}</td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-sm btn-primary download-paper-btn" data-id="${paper.id}">
                <i class="fas fa-download"></i>
                下载
              </button>
              <button class="btn btn-sm btn-outline view-paper-btn" data-id="${paper.id}">
                <i class="fas fa-eye"></i>
                查看
              </button>
            </div>
          </td>
        </tr>
      `;
    });
    
    html += `
        </tbody>
      </table>
    `;
    
    container.innerHTML = html;
    this.addPaperEventListeners();
  },
  
  // 渲染试卷表格
  renderPapersTable(searchTerm = '', category = '', year = '') {
    const container = document.getElementById('papers-table-body');
    
    if (this.state.isLoading) {
      return;
    }
    
    if (this.state.papers.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="5" style="text-align: center; padding: 40px;">
            <div class="empty-state">
              <div class="empty-state-icon">
                <i class="fas fa-search"></i>
              </div>
              <h3 class="empty-state-title">没有试卷数据</h3>
              <p class="empty-state-description">请检查data.txt文件是否存在且格式正确。</p>
            </div>
          </td>
        </tr>
      `;
      return;
    }
    
    // 筛选试卷（仅普通试卷，不包含QPhO）
    let filteredPapers = this.state.papers;
    
    if (searchTerm) {
      filteredPapers = filteredPapers.filter(paper =>
        paper.name.toLowerCase().includes(searchTerm) ||
        paper.description.toLowerCase().includes(searchTerm) ||
        paper.category.toLowerCase().includes(searchTerm)
      );
    }
    
    if (category) {
      filteredPapers = filteredPapers.filter(paper => paper.category === category);
    }
    
    if (year) {
      filteredPapers = filteredPapers.filter(paper => paper.year.toString() === year);
    }
    
    // 排序（最新优先）
    filteredPapers.sort((a, b) => {
      if (b.year !== a.year) return b.year - a.year;
      if (b.month !== a.month) return b.month - a.month;
      return b.day - a.day;
    });
    
    if (filteredPapers.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="5" style="text-align: center; padding: 40px;">
            <div class="empty-state">
              <div class="empty-state-icon">
                <i class="fas fa-search"></i>
              </div>
              <h3 class="empty-state-title">没有找到试卷</h3>
              <p class="empty-state-description">尝试调整筛选条件。</p>
            </div>
          </td>
        </tr>
      `;
      return;
    }
    
    let html = '';
    filteredPapers.forEach((paper, index) => {
      html += `
        <tr data-id="${paper.id}">
          <td>
            <a href="#" class="paper-title" style="font-weight: 600; color: var(--gray-900);">${paper.name}</a>
            <div style="font-size: 14px; color: var(--gray-600); margin-top: 4px;">
              ${paper.description.substring(0, 60)}...
            </div>
          </td>
          <td>${paper.year}</td>
          <td>${paper.category}</td>
          <td>${paper.date}</td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-sm btn-primary download-paper-btn" data-id="${paper.id}">
                <i class="fas fa-download"></i>
                下载
              </button>
              <button class="btn btn-sm btn-outline view-paper-btn" data-id="${paper.id}">
                <i class="fas fa-eye"></i>
                查看
              </button>
            </div>
          </td>
        </tr>
      `;
    });
    
    container.innerHTML = html;
    this.addPaperEventListeners();
  },
  
  // 渲染QPhO表格
  renderQphoTable() {
    const container = document.getElementById('qpho-table-body');
    
    if (this.state.isLoading) {
      return;
    }
    
    if (this.state.qphoPapers.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="5" style="text-align: center; padding: 40px;">
            <div class="empty-state">
              <div class="empty-state-icon">
                <i class="fas fa-bolt"></i>
              </div>
              <h3 class="empty-state-title">暂无QPhO试卷</h3>
              <p class="empty-state-description">请检查QPhO.txt文件是否存在且格式正确。</p>
            </div>
          </td>
        </tr>
      `;
      return;
    }
    
    // 排序（最新优先）
    const sortedPapers = [...this.state.qphoPapers].sort((a, b) => {
      if (b.year !== a.year) return b.year - a.year;
      if (b.month !== a.month) return b.month - a.month;
      return b.day - a.day;
    });
    
    let html = '';
    sortedPapers.forEach((paper, index) => {
      html += `
        <tr data-id="${paper.id}">
          <td>
            <div style="display: flex; align-items: center;">
              <a href="#" class="paper-title" style="font-weight: 600; color: var(--gray-900);">${paper.name}</a>
              <span class="qpho-badge" style="margin-left: 8px;">
                <i class="fas fa-bolt"></i>
                QPhO
              </span>
            </div>
            <div style="font-size: 14px; color: var(--gray-600); margin-top: 4px;">
              ${paper.description.substring(0, 60)}...
            </div>
          </td>
          <td>${paper.year}</td>
          <td>${paper.type}</td>
          <td>
            <span class="category-tag">
              ${paper.difficulty}
            </span>
          </td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-sm btn-qpho download-paper-btn" data-id="${paper.id}">
                <i class="fas fa-download"></i>
                下载
              </button>
              <button class="btn btn-sm btn-outline view-paper-btn" data-id="${paper.id}">
                <i class="fas fa-eye"></i>
                查看
              </button>
            </div>
          </td>
        </tr>
      `;
    });
    
    container.innerHTML = html;
    this.addPaperEventListeners();
  },
  
  // 添加试卷事件监听器
  addPaperEventListeners() {
    // 下载按钮
    document.querySelectorAll('.download-paper-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const paperId = btn.getAttribute('data-id');
        
        // 显示下载确认模态框
        this.showDownloadModal(paperId);
      });
    });
    
    // 查看按钮
    document.querySelectorAll('.view-paper-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const paperId = btn.getAttribute('data-id');
        this.showPaperDetails(paperId);
      });
    });
    
    // 表格中的试卷标题点击
    document.querySelectorAll('.paper-title').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const paperId = link.closest('tr').getAttribute('data-id');
        this.showPaperDetails(paperId);
      });
    });
  },
  
  // 更新统计信息
  updateStats() {
    if (this.state.isLoading) {
      document.getElementById('total-papers').textContent = '0';
      document.getElementById('total-years').textContent = '0';
      document.getElementById('total-categories').textContent = '0';
      document.getElementById('qpho-count').textContent = '0';
      return;
    }
    
    const allPapers = [...this.state.papers, ...this.state.qphoPapers];
    
    // 总试卷数量
    document.getElementById('total-papers').textContent = allPapers.length;
    
    // 年份跨度
    const allYears = new Set([...this.state.years, ...this.state.qphoYears]);
    const yearSpan = allYears.size > 0 ? 
      `${Math.min(...allYears)}-${Math.max(...allYears)}` : '0';
    document.getElementById('total-years').textContent = yearSpan;
    
    // 分类数量
    const categories = new Set();
    allPapers.forEach(paper => categories.add(paper.category));
    document.getElementById('total-categories').textContent = categories.size;
    
    // QPhO试卷数量
    document.getElementById('qpho-count').textContent = this.state.qphoPapers.length;
  },
  
  // 更新QPhO统计信息
  updateQphoStats() {
    const papers = this.state.qphoPapers;
    
    if (papers.length === 0) {
      document.getElementById('qpho-total').textContent = '0';
      document.getElementById('qpho-years').textContent = '0';
      document.getElementById('qpho-simulated').textContent = '0';
      document.getElementById('qpho-final').textContent = '0';
      document.getElementById('qpho-preliminary').textContent = '0';
      document.getElementById('qpho-latest').textContent = '2025';
      return;
    }
    
    // QPhO试卷总数
    document.getElementById('qpho-total').textContent = papers.length;
    
    // 年份跨度
    const years = Array.from(this.state.qphoYears);
    const yearSpan = years.length > 0 ? 
      `${Math.min(...years)}-${Math.max(...years)}` : '0';
    document.getElementById('qpho-years').textContent = yearSpan;
    
    // 各种类型的数量
    const simulated = papers.filter(p => p.type.includes('模拟')).length;
    const final = papers.filter(p => p.type.includes('决赛')).length;
    const preliminary = papers.filter(p => p.type.includes('初赛')).length;
    
    document.getElementById('qpho-simulated').textContent = simulated;
    document.getElementById('qpho-final').textContent = final;
    document.getElementById('qpho-preliminary').textContent = preliminary;
    
    // 最新年份
    const latestYear = papers.length > 0 ? 
      Math.max(...papers.map(paper => paper.year)) : 2025;
    document.getElementById('qpho-latest').textContent = latestYear;
  }
};

// 页面加载完成后初始化应用程序
document.addEventListener('DOMContentLoaded', () => {
  QPHO.init();
});
</script>
</body>
</html>